---
title: "Homework21"
format: html
editor: visual
---

# My first Chi-square contingency analysis

setup

```{r}
rm(list=ls())
library(tidyverse)
library(here)
```

import data

```{r}
lady <- read.csv(here("Data", "ladybirds.csv"))
glimpse(lady)
```
Grouping data for analysis

```{r}
totals <- lady |>
  group_by(Habitat, colour) |>
  summarise(total_number = sum(number))
```

Making a bar chart

```{r}
ggplot(totals, aes(x = Habitat, y = total_number, fill = colour))+
  geom_bar(stat = 'identity', position = 'dodge')+
  scale_fill_manual(values = c(black = "black", red = "red"))
  
```

making a matrix of lady data to do a chi sq


```{r}
ladymat <- xtabs(number ~ Habitat + colour, data = lady)
# this does the same thing as the group_by()and summarise() functions
```

doing a chi-square test
a test on the significance of your data. 

```{r}
lady.chi <- chisq.test(ladymat) 
names(lady.chi)#gives more information on the chisq test
```





















